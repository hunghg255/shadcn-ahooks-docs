---
title: useLocalStorageState
description: A Hook that store state into localStorage.
---

## Overview

A Hook that store state into localStorage.

[Documentation and Examples](https://ahooks.js.org/hooks/use-localstoragestate)

## Installation

<OpenInV0Button url="https://shadcn-ahooks.vercel.app/r/useLocalStorageState.json" />

<Tabs items={['pnpm', 'npm', 'yarn', 'bun']}>
  <Tab value="pnpm">
  ```bash
  pnpm dlx shadcn@latest add https://shadcn-ahooks.vercel.app/r/useLocalStorageState.json
  ```
  </Tab>
  <Tab value="npm">
  ```bash
  npx shadcn@latest add https://shadcn-ahooks.vercel.app/r/useLocalStorageState.json
  ```
  </Tab>
  <Tab value="yarn">
  ```bash
  yarn shadcn@latest add https://shadcn-ahooks.vercel.app/r/useLocalStorageState.json
  ```
  </Tab>
  <Tab value="bun">
  ```bash
  bun shadcn@latest add https://shadcn-ahooks.vercel.app/r/useLocalStorageState.json
  ```
  </Tab>
</Tabs>

A Hook that store state into localStorage.

## Examples

### Store state into localStorage


<Preview name="useLocalStorageState"
 code={`
import useLocalStorageState from '@/src/hooks/ahooks/useLocalStorageState';

const Example = () => {
  const [message, setMessage] = useLocalStorageState<string | undefined>(
    'use-local-storage-state-demo1',
    {
      defaultValue: 'Hello~',
    },
  );

  return (
    <>
      <input
        value={message || ''}
        placeholder="Please enter some words..."
        onChange={(e) => setMessage(e.target.value)}
      />
      <button style={{ margin: '0 8px' }} type="button" onClick={() => setMessage('Hello~')}>
        Reset
      </button>
      <button type="button" onClick={() => setMessage(undefined)}>
        Clear
      </button>
    </>
  );
};

export default Example;`} />

### Store complex types of data


<Preview name="useLocalStorageState"
 code={`
import useLocalStorageState from '@/src/hooks/ahooks/useLocalStorageState';

const defaultArray = ['a', 'e', 'i', 'o', 'u'];

const Example = () => {
  const [value, setValue] = useLocalStorageState('use-local-storage-state-demo2', {
    defaultValue: defaultArray,
  });

  return (
    <>
      <p>{value?.join('-')}</p>
      <button
        type="button"
        style={{ marginRight: '16px' }}
        onClick={() => setValue([...value, Math.random().toString(36).slice(-1)])}
      >
        push random
      </button>
      <button type="button" onClick={() => setValue(defaultArray)}>
        reset
      </button>
    </>
  );
};

export default Example;`} />

### Custom serialization and deserialization functions

<Preview name="useLocalStorageState"
 code={`
import useLocalStorageState from '@/src/hooks/ahooks/useLocalStorageState';

const Example = () => {
  const [message, setMessage] = useLocalStorageState<string | undefined>(
    'use-local-storage-state-demo3',
    {
      defaultValue: 'Hello~',
      serializer: (v) => v ?? '',
      deserializer: (v) => v,
    },
  );

  return (
    <>
      <input
        value={message || ''}
        placeholder="Please enter some words..."
        onChange={(e) => setMessage(e.target.value)}
      />
      <button style={{ margin: '0 8px' }} type="button" onClick={() => setMessage('Hello~')}>
        Reset
      </button>
      <button type="button" onClick={() => setMessage(undefined)}>
        Clear
      </button>
    </>
  );
};

export default Example;`} />

### Sync state with localStorage

<Preview name="useLocalStorageState"
 code={`
import useLocalStorageState from '@/src/hooks/ahooks/useLocalStorageState';


function Counter() {
  const [count, setCount] = useLocalStorageState('use-local-storage-state-demo4', {
    defaultValue: 0,
    listenStorageChange: true,
  });

  return (
    <div style={{ marginBottom: '8px' }}>
      <button style={{ marginRight: '8px' }} onClick={() => setCount(count! + 1)}>
        count: {count}
      </button>
      <button onClick={() => setCount()}>Clear</button>
    </div>
  );
}

const Example = () => {

  return (
     <>
      <Counter />
      <Counter />
    </>
  );
};

export default Example;`} />

## API

If you want to delete this record from localStorage, you can use `setState()` or `setState(undefined)`.

```typescript
type SetState<S> = S | ((prevState?: S) => S);

interface Options<T> {
  defaultValue?: T | (() => T);
  listenStorageChange?: boolean;
  serializer?: (value: T) => string;
  deserializer?: (value: string) => T;
  onError?: (error: unknown) => void;
}

const [state, setState] = useLocalStorageState<T>(
  key: string,
  options: Options<T>
): [T?, (value?: SetState<T>) => void];
```

### Result

| Property | Description                 | Type                            |
| -------- | --------------------------- | ------------------------------- |
| state    | Local `localStorage` value  | `T`                             |
| setState | Update `localStorage` value | `(value?: SetState<T>) => void` |

### Options

| Property            | Description                                                                                                                                                                                             | Type                       | Default                       |
| ------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------- | ----------------------------- |
| defaultValue        | Default value                                                                                                                                                                                           | `any \| (() => any)`       | -                             |
| listenStorageChange | Whether to listen storage changes. If `true`, when the stored value changes, all `useLocalStorageState` with the same `key` will synchronize their states, including different tabs of the same browser | `boolean`                  | `false`                       |
| serializer          | Custom serialization method                                                                                                                                                                             | `(value: any) => string`   | `JSON.stringify`              |
| deserializer        | Custom deserialization method                                                                                                                                                                           | `(value: string) => any`   | `JSON.parse`                  |
| onError             | On error callback                                                                                                                                                                                       | `(error: unknown) => void` | `(e) => { console.error(e) }` |

## Remark

useLocalStorageState will call `serializer` before write data to localStorage, and call `deserializer` once after read data.
