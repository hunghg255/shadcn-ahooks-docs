---
title: RefreshDeps
description: The API RefreshDeps of useRequest.
---

# RefreshDeps

By setting `options.refreshDeps`, `useRequest` will run [refresh](https://ahooks.js.org/hooks/use-request/basic/#result) automatically when dependencies change, achieving the effect of [Refresh (repeat the last request)](https://ahooks.js.org/hooks/use-request/basic/#refresh-repeat-the-last-request).

```tsx | pure
const [userId, setUserId] = useState('1');
const { data, run } = useRequest(() => getUserSchool(userId), {
  refreshDeps: [userId],
});
```

In the example code above, `useRequest` will execution when it is initialized and `userId` changes.

It is exactly the same with the following implementation

```tsx | pure
const [userId, setUserId] = useState('1');
const { data, refresh } = useRequest(() => getUserSchool(userId));

useEffect(() => {
  refresh();
}, [userId]);
```

### Repeat last request

<Preview name="useRequest"
 code={`

import useRequest from '@/src/hooks/ahooks/useRequest';
import { useState } from 'react';

function getUsername(id: number) {
  console.log('getUsername id:', id);

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve('H' + Math.random().toString(36).substring(7));
    }, 1000);
  });
}

const Example = () => {
   const [userId, setUserId] = useState<number>();
  const { data, loading, run } = useRequest((id: number) => getUsername(id), {
    refreshDeps: [userId],
  });

  return (
    <div>
    <p>Prev: {userId}</p>

      <p>Username: {loading ? 'loading...' : data}</p>
      <button onClick={() => setUserId(Math.random())}>Use previous id to refresh</button>
      <button onClick={() => run(Math.random())}>Use latest id to refresh</button>
    </div>
  );
};

export default Example;`} />


### Custom refresh

<Preview name="useRequest"
 code={`

import useRequest from '@/src/hooks/ahooks/useRequest';
import { useState } from 'react';

function getUsername(id: number) {
  console.log('getUsername id:', id);

  return new Promise((resolve) => {
    setTimeout(() => {
      resolve('H' + Math.random().toString(36).substring(7));
    }, 1000);
  });
}

const Example = () => {
   const [userId, setUserId] = useState<number>();
  const { data, loading, run } = useRequest((id: number) => getUsername(id), {
    refreshDeps: [userId],
    refreshDepsAction: () => {
      if (typeof userId !== 'number') {
        console.log('userId is invalid, skip refresh');
        return;
      }
      run(userId);
    },
  });

  return (
    <div>
    <p>Prev: {userId}</p>

      <p>Username: {loading ? 'loading...' : data}</p>
     <button onClick={() => setUserId(Math.random())}>
        Use latest id to refresh (by \`refreshDeps\`)
      </button>
      <button onClick={() => run(Math.random())}>Use latest id to refresh (by \`run\`)</button>
    </div>
  );
};

export default Example;`} />

## API

### Options

| Property          | Description                                                                                                   | Type                   | Default |
| ----------------- | ------------------------------------------------------------------------------------------------------------- | ---------------------- | ------- |
| refreshDeps       | When the content of the array changes, trigger refresh.                                                       | `React.DependencyList` | `[]`    |
| refreshDepsAction | Customize the request behavior during dependency refresh; this parameter is invoked when dependencies change. | `() => void`           | -       |

## Remark

- If you set `options.manual = true`, both `refreshDeps` and `refreshDepsAction` are no longer effective, you need to trigger the request by `run/runAsync`.
